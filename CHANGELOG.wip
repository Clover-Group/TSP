- internal overhaul, some bug fixes